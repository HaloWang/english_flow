# EnglishFlow

## è§£å†³ä»€ä¹ˆé—®é¢˜

1. æˆ‘éœ€è¦ç»å¸¸ StackOverflow, è‹±æ–‡æ–‡ç« , è‹±æ–‡æ–‡æ¡£, ä½†å…¶ä¸­æœ‰ä¸å°‘è‹±è¯­å•è¯æˆ‘ä¸çŸ¥é“ä»€ä¹ˆæ„æ€
2. è‹±æ–‡ç¤¾åŒºä¹Ÿæœ‰å¾ˆå¤šæœ‰è¶£çš„ä¸œè¥¿(æ¯”å¦‚ reddit.ProgrammerHumor)
3. æˆ‘å¸Œæœ›èƒ½é€æ¸æå‡è‡ªå·±çš„è‹±è¯­æ°´å¹³

ä½†æ˜¯

1. æˆ‘ç»å¸¸å¿˜è®°è‹±è¯­å•è¯çš„æ„æ€
2. æˆ‘ç»å¸¸ä¸ç¡®å®šè‡ªå·±å¯¹ä¸€ä¸ªå•è¯çš„ç†è§£æ˜¯æ­£ç¡®
3. å½“å‰å„ç§æŸ¥å•è¯çš„åº”ç”¨/ç½‘é¡µå¯¹äºæˆ‘æ¥è¯´éƒ½æœ‰äº›ç¹ç, å¿ƒæ™ºè´Ÿæ‹…è¾ƒå¤§
4. å…¨æ–‡ç¿»è¯‘, éœ€è¦é¢‘ç¹å¯¹æ¯”ä¸­æ–‡æ®µè½ä¸è‹±æ–‡æ®µè½, å¿ƒæ™ºè´Ÿæ‹…è¾ƒå¤§
5. ä¸‹è¿°åº”ç”¨ä¸èƒ½å®Œå…¨æ»¡è¶³éœ€æ±‚
   - Google Translate
   - DeepL
   - Youdao
   - Google Search: 'define FooBar'
   - Google Search: 'pronounce FooBar'

æ‰€ä»¥æˆ‘å¸Œæœ›æœ‰ä¸€ç§åŠŸèƒ½:

1. ä¸ç ´åå½“å‰è‹±æ–‡çš„ä¸Šä¸‹æ–‡, ä¸ç¦»å¼€å½“å‰ç½‘é¡µ
2. å¿«é€Ÿè·å–ä¸­æ–‡é‡Šä¹‰
3. é¡ºä¾¿ä¼˜åŒ–ä»¥ä¸‹æŸ¥å•è¯çš„ä½“éªŒ

æ‰€ä»¥æˆ‘å†™äº†è¿™ä¸ªå«åš EnglishFlow (ä»¥ä¸‹ç®€ç§° EF)çš„è„šæœ¬

## åŠŸèƒ½å±•ç¤º

![StackOverflow](./screenshots/1.gif)
![Github](./screenshots/2.gif)
![Wikipedia](./screenshots/3.gif)
![React](./screenshots/4.gif)

## ä½¿ç”¨æµç¨‹

### å‰ç½®æ¡ä»¶

- éœ€è¦åœ¨ç”µè„‘ä¸Šå®‰è£… node+npm+yarn
- éœ€è¦ç¼–è¾‘å™¨, æ¨è vscode
- ä¸€ä¸ç‚¹å„¿ yaml ä¹¦å†™èƒ½åŠ›
- åœ¨æµè§ˆå™¨ä¸­å®‰è£… [TamperMonkey](https://www.tampermonkey.net/) (ä»¥ä¸‹ç®€ç§° TM) æ’ä»¶(extension)
  - ä¸€äº›åŸºç¡€çš„ TM çŸ¥è¯†
  - è¯·ç¡®ä¿ TM æœ‰è®¿é—®æœ¬åœ°æ–‡ä»¶çš„æƒé™

### å¼€å¯é¡¹ç›®

1. clone/download
2. å°†æœ¬é¡¹ç›®ç§»åŠ¨è‡³**æ¡Œé¢(Desktop)**
3. `yarn`
   - æ·»åŠ ä¾èµ–
4. `yarn ts_build`
   - ç¼–è¯‘ index.ts / server.ts è‡³ dist ä¸­
5. `yarn w_tools`
   - `_w_dict`: ç›‘å¬ src/data/dictionary.yaml, ç¼–è¯‘ä¸º json
   - `_w_profile`: ç›‘å¬ src/data/profile.yaml, ç¼–è¯‘ä¸º json
   - `_w_style`: ç›‘å¬ src/frontend/style.less, ç¼–è¯‘ä¸º css
   - `_w_entry`: ç›‘å¬ entry/template.js, æ”¹å†™å…¶ @require/@resource
6. `yarn serve`
   - å¼€å¯ node.js æœåŠ¡å™¨, ä½œä¸ºè¿è¡Œåœ¨ TM ä¸­ EF çš„æ•°æ®æº
     - EF å½“å‰ä½¿ç”¨è½®è¯¢çš„æ–¹å¼å’ŒæœåŠ¡å™¨äº¤äº’

### åœ¨ TM ä¸­æ·»åŠ è„šæœ¬

1. æ‰“å¼€ chrome
2. æ‰“å¼€ TM
3. æ·»åŠ æ–°è„šæœ¬
4. åœ¨æœ¬é¡¹ç›®ä¸­æ‰¾åˆ° dist/tampermonkey_entry.js å°†å…¶ä¸­çš„å†…å®¹å…¨é€‰+å¤åˆ¶, å¹¶å…¨éƒ¨æ›¿æ¢ä¸Šä¸€æ­¥ä¸­ chrome.TM å·²ç»æ˜¾ç¤ºçš„ç¼–è¾‘å™¨é¡µé¢ä¸­çš„ä»£ç , ä¿å­˜
5. ç¡®ä¿æœ¬é¡¹ç›®æ–‡ä»¶å¤¹åœ¨ç”µè„‘çš„æ¡Œé¢
6. åˆ·æ–°é¡µé¢, æ‰“å¼€æŸä¸ªè‹±æ–‡ wikipedia, ä½ åº”è¯¥èƒ½çœ‹åˆ° EF å·²ç»åœ¨è¿è¡Œäº†

### æ·»åŠ è‹±æ–‡ç½‘é¡µæ ‡è¯†

_ğŸš§ æˆ‘å·²ç»åœ¨å…¶ä¸­æ·»åŠ äº†å¾ˆå¤šç½‘å€äº†_

åœ¨ `profile.yaml` ä¸­æ·»åŠ éœ€è¦è¿è¡Œ ef çš„ç½‘é¡µ

åœ¨ old.contain ä¸­æ·»åŠ ç›®æ ‡ç½‘å€åŒ…å«çš„å­—ç¬¦ä¸²å°±è¡Œäº†, æ³¨æ„ `,` å·. å½“ç„¶ä¼šæœ‰é‡å¤ç½‘å€å’Œå†²çªç½‘å€çš„é—®é¢˜, è¿˜æ²¡å®ç°

- contain: å½“å‰ç½‘é¡µçš„ url å¦‚æœåŒ…å« contain ä¸­çš„å­—ç¬¦ä¸², åˆ™ä½¿ç”¨è¯¥ profile
- rootSelector: ä»é‚£äº›èŠ‚ç‚¹å¼€å§‹éå†
- style: ç‹¬ç‰¹çš„æ ·å¼
- strategies: è„šæœ¬æ‰§è¡Œç­–ç•¥
- notMatchClassName: ä¸åŒ¹é…å“ªäº› className

### å¼€å§‹é˜…è¯»è‹±æ–‡ç½‘é¡µ

è¿™å°±æ˜¯æˆ‘çš„éœ€æ±‚æ¥æº

### æŸ¥è¯¢å•è¯

- `shift+E`, æ ¹æ®é€‰ä¸­çš„å…³é”®å­—(çŸ­è¯­/å¥å­)å‘éŸ³
- `shift+D`, æ ¹æ®é€‰ä¸­çš„å…³é”®å­—(çŸ­è¯­/å¥å­)**å‘éŸ³**, å¹¶**è®¾ç½®ç²˜è´´æ¿**ä¸ºå½“å‰å•è¯, å¿«æ·**æ‰“å¼€å¦‚ä¸‹ç½‘é¡µ**
  - æœ‰é“è¯å…¸
  - Google Translate
    - è¯é¢‘ä¿¡æ¯å¯¹æˆ‘æ¥è¯´æ¯”è¾ƒé‡è¦
  - å¯è‡ªè¡Œæ·»åŠ : Google search define XXX
  - å¯è‡ªè¡Œæ·»åŠ : Google search pronounce XXX
  - å¯è‡ªè¡Œæ·»åŠ : Deepl XXX
- EF è¿™æ—¶ä¼šåŒæ—¶æŸ¥è¯¢ google translate çš„å‘éŸ³
- æˆ‘ç»å¸¸å‚è€ƒæœ‰é“è¯å…¸çš„è”æƒ³åŠŸèƒ½æ¥ä¿®é¥°(åˆ é™¤æœ«å°¾)æˆ‘åœ¨ dictionary.yaml å†™å…¥çš„å…³é”®å­—
- `shift+R`, å½“è¯¥å•è¯å·²ç»è¢«æ·»åŠ è‡³ dictionary.yaml å¿ åš, å¦‚æœé¼ æ ‡æ‚¬åœåœ¨è¯¥å•è¯ä¸Š, åˆ™å‘éŸ³
- `shift+F`, å½“è¯¥å•è¯å·²ç»è¢«æ·»åŠ è‡³ dictionary.yaml å¿ åš, å¦‚æœé¼ æ ‡æ‚¬åœåœ¨è¯¥å•è¯ä¸Š, åˆ™å¿«æ·æ‰“å¼€å¦‚ä¸‹ç½‘é¡µ, åŒæ—¶å‘éŸ³

#### å‘éŸ³

- ä¼˜å…ˆæŸ¥è¯¢ Google çš„å‘éŸ³
- youdao çš„å‘éŸ³ä¹Ÿå¯ä»¥æ·»åŠ , ä½†æ˜¯é€šå¸¸æƒ…å†µä¸‹æˆ‘è¿˜æ˜¯æƒ³é€‰ Google
- å¦‚æœæ²¡æœ‰ç»“æœ, æˆ–è€…é€‰ä¸­å‘éŸ³çš„æ˜¯ä¸€ä¸ªå¥å­, åˆ™ä½¿ç”¨ [SpeechSynthesis](https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis) API
- æŸ¥è¯¢å•è¯çš„åŠŸèƒ½ä¸éœ€è¦åœ¨ profile.yaml ä¸­æ·»åŠ å¯¹åº”ç½‘ç«™å³å¯è¿ä½œ

#### ä¹Ÿå¯ä»¥æŸ¥è¯¢è¯­å¥

ä½¿ç”¨ `shift+D` ä¹Ÿå¯ä»¥å¿«æ·æŸ¥è¯¢è¯­å¥

### æ·»åŠ å•è¯/åŠ©è®°æ ‡è¯†/ä¼ªè¯æ ¹

- _ğŸš§ æˆ‘å·²ç»åœ¨å…¶ä¸­æ·»åŠ äº†å¾ˆå¤šå•è¯äº†_

- æ‰“å¼€ `dictionary.yaml`, æ·»åŠ å•è¯, æˆ‘é€‰æ‹©ä½¿ç”¨ `|` æ¥åˆ†éš”åŒä¸€ä¸ªå•è¯(ä¼ªå•è¯/ä¼ªè¯æ ¹)çš„é‡Šä¹‰

#### ä¸ªäººä¹ æƒ¯

- æˆ‘ä¸ªäººä¼šå°½é‡åˆå¹¶ç›¸åŒè¯æ ¹çš„å•è¯
  - NotFull è¡¨ç¤ºä¸åŒ¹é…å’Œè¯¥ key å®Œå…¨ç›¸åŒçš„å•è¯
    - æ¯”å¦‚ `foo` åŒ¹é… foobar, è€Œä¸å¿…é… foo
  - FullMatch è¡¨ç¤ºä»…ä»…åŒ¹é…å’Œè¯¥ key å®Œå…¨ç›¸åŒçš„å•è¯
    - æ¯”å¦‚ `foo` åŒ¹é… foo, è€Œä¸å¿…é… foobar

### å›åˆ°ç½‘é¡µ

- ä½ ä¼šå‘ç°ä½ åˆšæ‰æ·»åŠ çš„æ ‡è¯†(å…³é”®å­—)å·²ç»åŒæ­¥åˆ°ç½‘é¡µä¸Šäº†

### è¯å…¸å½“ç„¶åº”è¯¥æ ¹æ®é¦–å­—æ¯

æˆ‘ä¼šåŒæ—¶ç¼–è¯‘ä¸€ä»½æ ¹æ® keyword é‡æ–°æ’åºçš„ DONT_USE_dictionary.yaml è‡³ dist/data ä¸­, æ‰‹åŠ¨ copy è‡³ src/data/dictionary.yaml å³å¯

## è‡ªè¡Œå¼€å‘

### æ ¸å¿ƒé€»è¾‘

å¼€å¯ç½‘é¡µå, EF ä¼šä»¥ profile.yaml ä¸­é…ç½®çš„ `rootSelector` ä¸ºæ ¹èŠ‚ç‚¹éå† DOM ä¸­çš„ `Text`. å¦‚æœå‘ç° `Text` ä¸­çš„æ–‡æœ¬èƒ½åŒ¹é…åˆ° dictionary.yaml ä¸­æ·»åŠ çš„ keyword, åˆ™å°†å…¶æ›¿æ¢ä¸ºåä¸º `eft` çš„æ ‡ç­¾

åœ¨ç½‘é¡µä¸Šåˆ›å»ºä¸€ä¸ª id ä¸º `ef-word-detail-panel` çš„æ ‡ç­¾, ç”¨äºå±•ç¤ºå•è¯çš„ç¿»è¯‘

é€šè¿‡ç›‘å¬ `eft` æ ‡ç­¾çš„ `mouseenter` äº‹ä»¶, EF ä¼šä½¿ç”¨ `#ef-word-detail-panel` åœ¨ç½‘é¡µä¸Šå±•ç¤ºå¯¹åº”å•è¯çš„ç¿»è¯‘, ä»¥æ­¤æ¥è¾¾åˆ°åŠ©è®°/æé†’çš„æ•ˆæœ. è®©æˆ‘å¯ä»¥ä¸è„±ç¦»ä¸Šä¸‹æ–‡è·å–è‹±æ–‡å•è¯çš„æ„æ€. å¹¶ä¸”ä»…ä»…åœ¨æœ‰éœ€è¦æ—¶"èƒŒ"è¿™ä¸ªå•è¯(ä¼ªè¯æ ¹)

EF ä¼šä»¥è½®è¯¢çš„æ–¹å¼è¯·æ±‚æœ¬åœ°åœ¨ `localhost:8000` å¼€å¯çš„ node.js server, å½“ dictionary.yaml å˜æ›´æ—¶, EF ä¼šåˆ·æ–°æ•´ä¸ªé¡µé¢

### ç½‘é¡µç«¯ä¸»è¦åŠŸèƒ½

src/index.ts

### æ ·å¼

style.less

## TODO (or not)

### ä¸€éƒ¨åˆ†é¡µé¢ä¸å…è®¸ä½¿ç”¨ audio å‘å£°

> Refused to load media from '<URL>' because it violates the following Content Security Policy directive: "media-src github.com user-images.githubusercontent.com/".

æ¯”å¦‚ github, MDN

è€ƒè™‘ä½¿ç”¨ Blob

### ç›‘å¬ profile.yaml

- å½“ profile.yaml ä¸­æ·»åŠ æˆ–å‡å°‘é¡µé¢æ—¶, åˆ·æ–°é¡µé¢
- `profile.yaml` è¿˜éœ€è¦è°ƒæ•´

### Others

- åˆå¹¶ yarn è„šæœ¬, å¹¶ä¸”å»é™¤ä¸åŒè„šæœ¬ä¹‹é—´çš„ä¾èµ–, æ˜¯ä¸æ˜¯è¦è€ƒè™‘ pipeline/webpack?
- åœ¨ yaml ä¸­è¾“å…¥çš„æ ¼å¼æœ‰é”™æ—¶, è„šæœ¬ä¸åº”è¯¥ä¸­æ–­. w_tools å’Œ serve ä¸åº”è¯¥æœ‰æ—¶é—´ä¸Šçš„ä¾èµ–
- æ’­æ”¾å£°éŸ³çš„åŠŸèƒ½è¿˜ä¸æ˜¯å¤ªå¥½
- ä»£ç è¿˜éœ€è¦ä¼˜åŒ–
  - è¿˜æ²¡åˆ†æ–‡ä»¶
    - æˆ‘æ— æ³•ä½¿ç”¨ tsc å°†å¤šä¸ª ts æ–‡ä»¶ç¼–è¯‘ä¸ºä¸€ä¸ª js æ–‡ä»¶, å¹¶ä¸”è®©è¯¥ js å¯ä»¥åœ¨ TM ä¸­ä½¿ç”¨. éè¦è¿™æ ·åšçš„è¯éœ€è¦ä½¿ç”¨ webpack
- æ›¿æ¢å¹¶æ·»åŠ  `eft` è¿™ä¸ªæ“ä½œ, åœ¨ä¸€å°éƒ¨åˆ†é¡µé¢ä¼šå¯¼è‡´æ ·å¼é”™è¯¯, ä½†æ˜¯æˆ‘éš¾ä»¥æ’æŸ¥é—®é¢˜æ‰€åœ¨
  - ä¸€äº› Google Search
  - æä¸ªåˆ«çš„ npmjs.com
- æ›´å¼ºçš„åŒ¹é…é€»è¾‘, é’ˆå¯¹å„ç§åˆæˆè¯æ±‡, åŒ¹é…æ—¶ä¸åº”è¯¥ä»…ä»…ä»å‰é¢åŒ¹é…?

### æ€§èƒ½

ç°åœ¨æˆ‘æš‚æ—¶æ²¡æœ‰å‘ç°æ€§èƒ½é—®é¢˜, ä» taskmgr çœ‹æ€§èƒ½å ç”¨çº¦ä¸º 1%. Chrome devtool Performance é¡µé¢æˆ‘æš‚æ—¶ä¸å¤ªä¼šç”¨ ğŸ˜‚

## Q&A

### ä¸ºå•¥ä¸ç”¨å„ç§å­—å…¸ API?

æˆ‘çœ‹äº†çœ‹æ²¡æœ‰å•¥æˆ‘æƒ³ç”¨çš„

### å¦‚æœæˆ‘ä¸æƒ³ä¸€ä¸ªä¸€ä¸ªæ·»åŠ å•è¯æ€ä¹ˆåŠ? æˆ‘å¯ä»¥ç›´æ¥å¯¼å…¥å­—å…¸å—?

æˆ‘ä¸ªäººçš„é€‰æ‹©æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„æ·»åŠ , å½“ç„¶ä¹Ÿå¯ä»¥å…¨é‡æ·»åŠ . æœ‰éœ€è¦çš„è¯å¯ä»¥å°† [github.ecditc](https://github.com/skywind3000/ECDICT) ä¸­çš„ csv æ•°æ®ç¼–è¯‘ä¸º json ... å½“ç„¶å¦‚æœä½ å·²ç»è¿™æ ·åšäº†çš„è¯, ç›¸ä¿¡ä½ ä¸ä¸€å®šæ„¿æ„ä½¿ç”¨ EF ä¸­ç°æœ‰çš„, ä»¥ json æ ¼å¼å­˜å‚¨çš„æ•°æ®. å½“å‰ EF æ¯æ¬¡ä»æœ¬åœ°æœåŠ¡å™¨å…¨é‡æ‹‰å–å­—å…¸æ•°æ®(30kb)å¯¹äº ecdit ä¸­åŠ¨è¾„ 100mb çš„ä¹Ÿæ˜¯ä¸å¯å–çš„. åŒæ—¶, [å½“å‰ TM æ— æ³•åšåˆ°æ‡’åŠ è½½æ•°æ®](https://github.com/TM/TM/issues/1461). æƒ³å¯¼å…¥å¹¶ä½¿ç”¨ ecdict ä¹‹ç±»è¶…å¤§å‹çš„å­—å…¸è¿˜æ˜¯éœ€è¦æŒ‰ç…§æŒ‰ç…§å•è¯å‘ local server è¯·æ±‚æ•°æ®

æ€»çš„æ¥è¯´:

1. è¦å°† csv è½¬åŒ–ä¸º database, æˆ–ä»»æ„å·²æœ‰çš„æ•°æ®åº“
2. node.js server è¦å®ç°æŸ¥è¯¢ DB çš„åŠŸèƒ½
3. index.ts ä¸­çš„ getWordDetail è¦æ”¹å†™ä¸º Promise å½¢å¼
4. å‰ç«¯åšä¸€ä¸‹ throttle
5. éœ€è¦å¿å—å¤§é‡çš„, å¯èƒ½è¿™è¾ˆå­éƒ½ç”¨ä¸åˆ°çš„å•è¯

### ç”¨äº†è¿™ä¸ªè„šæœ¬å°±èƒ½è¯»æ‡‚è‹±æ–‡äº†å—?

ä¸èƒ½å®Œå…¨è¯»æ‡‚æ¯ä¸€å¥è¯. ä»¥æˆ‘å½“å‰çš„æ°´å¹³é•¿éš¾å¥è¿˜æ˜¯è¦æ…¢æ…¢ç†è§£

æ¯”å¦‚ä¸‹é¢è¿™å¥è¯:

> Are you confident that, given that it appears to have done so every day throughout your entire life and presumably the entire existence of humanity beforehand, the sun will once again rise tomorrow?

EF çš„æ•ˆæœå¤§è‡´æ•ˆæœ:

> Are you confident(è‡ªä¿¡) that, given that it appears to have done so every day throughout(å§‹ç»ˆ) your entire life and presumably(æƒ³å¿…) the entire existence of humanity(äººç±») beforehand(äº‹å‰), the sun will once again rise tomorrow?

æ‰€ä»¥[è¿™å¥è¯](https://www.reddit.com/r/askphilosophy/comments/hqk1q0/comment/fxyfcgq/?utm_source=share&utm_medium=web2x&context=3)åœ¨è¯´å•¥? æˆ‘å®Œå…¨ä¸çŸ¥é“...è¿™æ˜¯åœ¨è¯´è‹±è¯­å—?

è¿˜å¾—å€ŸåŠ© Google Translate / youdao æ‰èƒ½æ…¢æ…¢äº†è§£è¿™å¥è¯çš„æ„æ€:

1. ä½ æ˜¯å¦æœ‰è‡ªä¿¡ that?
2. è€ƒè™‘(given it)åˆ° it æ¯å¤©éƒ½å®Œæˆ
3. it è´¯ç©¿(ä½ ç”Ÿå‘½çš„å§‹ç»ˆ/äººç±»å­˜åœ¨ä¹‹å‰)
4. it = (the sun will once again rise tomorrow)

æœ€ç»ˆ:

ä½ æ˜¯å¦ä¼šæ€€ç–‘, å¤ªé˜³ä¼šåœ¨æ˜æ—©å†æ¬¡å‡èµ·è¿™ä»¶è´¯ç©¿ä½ ç”Ÿå‘½å§‹ç»ˆ, ä¹ƒè‡³æ•´ä¸ªäººç±»å†å²çš„äº‹?

### Chrome Extension Store ä¸Šæœ‰å¾ˆå¤šåŒæ ·åŠŸèƒ½çš„æ’ä»¶, ä½ è¦å’Œä»–ä»¬ç«äº‰å—?

æˆ‘æƒ³è¦çš„æ˜¯åŠæ—¶æ»¡è¶³è‡ªå·±çš„éœ€æ±‚

### æœ‰é“å­—å…¸ç”¨æˆ·å•è¯æœ¬å¯ä»¥å¯¼å…¥å—?

æ²¡å¼€å‘, ä½†æ˜¯æŠ€æœ¯ä¸Šæœ‰é“å¯¼å‡ºçš„è¯åº“æ–‡ä»¶è½¬åŒ–æˆä»»æ„çš„æ•°æ®æ ¼å¼éƒ½æ˜¯å¯è¡Œçš„
